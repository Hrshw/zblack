<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot Password</title>
  <link rel="stylesheet" href="cs/style.css">
  <link rel="stylesheet" href="../css/bootstrap.min.css">
</head>
<style>
  body {
    background-image: url(images/forgotpassword-bg.jpg);
    width: 100%;
    background-position: center;
    background-repeat: no-repeat;
    scroll-behavior: smooth;
    overflow-x: hidden;
  }

  .btn {
    background-color: #98464e;
  }

  .btn:hover {
    background-color: #c82333;
    border-color: #c82333;
  }
</style>

<body>
  
    <div class="container mt-4 w-75 d-flex flex-column justify-content-center p-5 rounded-4 mt-5">
      <div id="flashSuccessMessage" class="alert alert-success" style="display: none;"></div>
      <div id="flashErrorMessage" class="alert alert-danger" style="display: none;"></div>

      <h1 class="mt-5 text-white text-center">Forgot Password</h1>
      <form id="forgotPasswordForm" class="mt-4 w-50 m-auto text-white">
        <div class="mb-3">
          <label for="email" class="form-label fs-4">Your email:</label>
          <input type="email" id="email" name="email" class="form-control" required>
        </div>

        <button type="submit" class="btn">Reset Password</button>
      </form>
    </div>
  

  <script src="js/bootstrap/bootstrap.bundle.min.js"></script>
  <script src="../jq/jquery.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var flashErrorMessage = document.getElementById('flashErrorMessage');

      if (flashErrorMessage) {
        setTimeout(function () {
          flashErrorMessage.style.display = 'none';
        }, 4000); // Hide error message after 4 seconds
      }

      var forgotPasswordForm = document.getElementById('forgotPasswordForm');
      if (forgotPasswordForm) {
        forgotPasswordForm.addEventListener('submit', function (e) {
          e.preventDefault();

          // Retrieve the form data
          var email = document.getElementById('email').value;

          // Send an AJAX request to the server
          var xhr = new XMLHttpRequest();
          xhr.open('POST', '/forgot-password', true);
          xhr.setRequestHeader('Content-Type', 'application/json');
          xhr.onload = function () {
            if (xhr.status === 200) {
              // Password reset instructions sent successfully
              var response = JSON.parse(xhr.responseText);
              var flashSuccessMessage = document.getElementById('flashSuccessMessage');
              if (flashSuccessMessage) {
                flashSuccessMessage.innerHTML = response.message;
                flashSuccessMessage.style.display = 'block';
                setTimeout(function () {
                  flashSuccessMessage.style.display = 'none';
                  window.location.href = '/'; // Redirect to the home page
                }, 3000); // Display the message for 3 seconds
              }
            } else {
              // Failed to process password reset request
              var flashErrorMessage = document.getElementById('flashErrorMessage');
              if (flashErrorMessage) {
                flashErrorMessage.innerHTML = 'Failed to process password reset request: ' + xhr.statusText;
                flashErrorMessage.style.display = 'block';
              }
            }
          };
          xhr.onerror = function () {
            // Failed to process password reset request
            var flashErrorMessage = document.getElementById('flashErrorMessage');
            if (flashErrorMessage) {
              flashErrorMessage.innerHTML = 'Failed to process password reset request';
              flashErrorMessage.style.display = 'block';
            }
          };
          xhr.send(JSON.stringify({ email: email }));
        });
      }
    });
  </script>


</body>

</html>